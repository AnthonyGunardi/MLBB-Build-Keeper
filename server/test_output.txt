
> mlbb-build-keeper-server@1.0.0 test
> jest --coverage

PASS src/tests/hero.service.test.js
PASS src/tests/user.model.test.js
PASS src/tests/auth.controller.test.js
  ‚óè Console

    console.log
      [dotenv@17.2.3] injecting env (8) from .env -- tip: ‚öôÔ∏è  load multiple .env files with { path: ['.env.local', '.env'] }

      at _log (node_modules/dotenv/lib/main.js:142:11)

PASS src/tests/heroSearch.test.js
  ‚óè Console

    console.log
      [dotenv@17.2.3] injecting env (8) from .env -- tip: ‚öôÔ∏è  write to custom object with { processEnv: myObject }

      at _log (node_modules/dotenv/lib/main.js:142:11)

PASS src/tests/auth.service.test.js
  ‚óè Console

    console.log
      [dotenv@17.2.3] injecting env (8) from .env -- tip: ‚öôÔ∏è  suppress all logs with { quiet: true }

      at _log (node_modules/dotenv/lib/main.js:142:11)

PASS src/tests/chat.controller.test.js
PASS src/tests/back_services.test.js
  ‚óè Console

    console.log
      [dotenv@17.2.3] injecting env (8) from .env -- tip: üë• sync secrets across teammates & machines: https://dotenvx.com/ops

      at _log (node_modules/dotenv/lib/main.js:142:11)

PASS src/tests/middleware.test.js
PASS src/tests/build.controller.test.js
  ‚óè Console

    console.log
      [dotenv@17.2.3] injecting env (8) from .env -- tip: ‚öôÔ∏è  override existing env vars with { override: true }

      at _log (node_modules/dotenv/lib/main.js:142:11)

PASS src/tests/config.test.js
PASS src/tests/gemini.guardrails.test.js
  ‚óè Console

    console.log
      warn: GEMINI_API_KEY is not set in environment variables. {"timestamp":"2025-12-29T09:51:47.036Z"}

      at Console.log (node_modules/winston/lib/winston/transports/console.js:87:23)

PASS src/tests/gemini.service.test.js
PASS src/tests/logger.test.js
PASS src/tests/models.index.test.js
PASS src/tests/build.service.test.js
FAIL src/tests/heroSeeder.service.test.js
  ‚óè Test suite failed to run

    TypeError: Cannot read properties of undefined (reading 'on')

    [0m [90m 16 |[39m   format[33m:[39m winston[33m.[39mformat[33m.[39mcombine(winston[33m.[39mformat[33m.[39mtimestamp()[33m,[39m winston[33m.[39mformat[33m.[39mjson())[33m,[39m
     [90m 17 |[39m   transports[33m:[39m [
    [31m[1m>[22m[39m[90m 18 |[39m     [36mnew[39m [33mDailyRotateFile[39m({
     [90m    |[39m     [31m[1m^[22m[39m
     [90m 19 |[39m       filename[33m:[39m path[33m.[39mjoin(logDir[33m,[39m [32m'error-%DATE%.log'[39m)[33m,[39m
     [90m 20 |[39m       datePattern[33m:[39m [32m'YYYY-MM-DD'[39m[33m,[39m
     [90m 21 |[39m       level[33m:[39m [32m'error'[39m[33m,[39m[0m

      at BubbleEvents (node_modules/file-stream-rotator/FileStreamRotator.js:690:13)
      at Object.FileStreamRotator.getStream (node_modules/file-stream-rotator/FileStreamRotator.js:545:9)
      at new DailyRotateFile (node_modules/winston-daily-rotate-file/daily-rotate-file.js:81:57)
      at Object.<anonymous> (src/utils/logger.js:18:5)
      at Object.require (src/services/heroSeeder.js:5:16)
      at Object.require (src/tests/heroSeeder.service.test.js:24:27)

PASS src/tests/hero.controller.test.js
  ‚óè Console

    console.log
      [dotenv@17.2.3] injecting env (8) from .env -- tip: üì° add observability to secrets: https://dotenvx.com/ops

      at _log (node_modules/dotenv/lib/main.js:142:11)

PASS src/tests/security.test.js
  ‚óè Console

    console.log
      [dotenv@17.2.3] injecting env (8) from .env -- tip: üîê encrypt with Dotenvx: https://dotenvx.com

      at _log (node_modules/dotenv/lib/main.js:142:11)

------------------|---------|----------|---------|---------|-------------------
File              | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s 
------------------|---------|----------|---------|---------|-------------------
All files         |   99.74 |      100 |     100 |   99.74 |                   
 src              |     100 |      100 |     100 |     100 |                   
  app.js          |     100 |      100 |     100 |     100 |                   
 src/config       |     100 |      100 |     100 |     100 |                   
  config.js       |     100 |      100 |     100 |     100 |                   
 src/controllers  |   99.23 |      100 |     100 |   99.21 |                   
  auth.js         |     100 |      100 |     100 |     100 |                   
  build.js        |     100 |      100 |     100 |     100 |                   
  chat.js         |     100 |      100 |     100 |     100 |                   
  hero.js         |   98.38 |      100 |     100 |   98.27 | 111               
 src/middlewares  |     100 |      100 |     100 |     100 |                   
  auth.js         |     100 |      100 |     100 |     100 |                   
  errorHandler.js |     100 |      100 |     100 |     100 |                   
  limiters.js     |     100 |      100 |     100 |     100 |                   
  upload.js       |     100 |      100 |     100 |     100 |                   
 src/models       |     100 |      100 |     100 |     100 |                   
  hero.js         |     100 |      100 |     100 |     100 |                   
  hero_build.js   |     100 |      100 |     100 |     100 |                   
  user.js         |     100 |      100 |     100 |     100 |                   
 src/routes       |     100 |      100 |     100 |     100 |                   
  auth.js         |     100 |      100 |     100 |     100 |                   
  build.js        |     100 |      100 |     100 |     100 |                   
  chat.js         |     100 |      100 |     100 |     100 |                   
  hero.js         |     100 |      100 |     100 |     100 |                   
  index.js        |     100 |      100 |     100 |     100 |                   
 src/services     |     100 |      100 |     100 |     100 |                   
  auth.js         |     100 |      100 |     100 |     100 |                   
  build.js        |     100 |      100 |     100 |     100 |                   
  gemini.js       |     100 |      100 |     100 |     100 |                   
  hero.js         |     100 |      100 |     100 |     100 |                   
 src/utils        |     100 |      100 |     100 |     100 |                   
  logger.js       |     100 |      100 |     100 |     100 |                   
------------------|---------|----------|---------|---------|-------------------

Test Suites: 1 failed, 17 passed, 18 total
Tests:       127 passed, 127 total
Snapshots:   0 total
Time:        4.682 s
Ran all test suites.
